import{_ as e,r as l,o,c as p,b as s,a as t,w as r,d as n,e as c}from"./app-9f19ef42.js";const i={},d=s("h1",{id:"retrying-重试任务",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#retrying-重试任务","aria-hidden":"true"},"#"),n(" retrying - 重试任务")],-1),D={class:"table-of-contents"},y=c(`<h2 id="_1-项目简介" tabindex="-1"><a class="header-anchor" href="#_1-项目简介" aria-hidden="true">#</a> 1. 项目简介</h2><p><code>retrying</code> 是一个 Python 重试任务的工具包。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> random</span></span>
<span class="line"><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> retrying </span><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> retry</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DCDCAA;">@retry</span></span>
<span class="line"><span style="color:#569CD6;">def</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">do_something_unreliable</span><span style="color:#D4D4D4;">():</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> random.randint(</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">, </span><span style="color:#B5CEA8;">10</span><span style="color:#D4D4D4;">) &gt; </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#C586C0;">raise</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">IOError</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Broken sauce, everything is hosed!!!111one&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#C586C0;">else</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;Awesome sauce!&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DCDCAA;">print</span><span style="color:#D4D4D4;">(do_something_unreliable())</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>还可以包含参数：</p><div class="language-python" data-ext="py"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#DCDCAA;">@retry</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">stop_max_attempt_number</span><span style="color:#D4D4D4;">=</span><span style="color:#B5CEA8;">7</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#569CD6;">def</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">stop_after_7_attempts</span><span style="color:#D4D4D4;">():</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#DCDCAA;">print</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Stopping after 7 attempts&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"></span></code></pre></div><p>可用参数：</p><ul><li><code>stop_max_attempt_number</code>：最大重试次数</li><li><code>stop_max_delay</code>：重试指定在指定时间内完成</li><li><code>wait_fixed</code>：固定的重试等待时间</li><li><code>wait_random_min</code>：最小随机等待时间（毫秒）</li><li><code>wait_random_max</code>：最大随机等待时间（毫秒）</li><li><code>wait_exponential_multiplier</code>：指数等待时间的基数（毫秒）</li><li><code>wait_exponential_max</code>：指数等待时间的最大值（毫秒）</li><li><code>retry_on_exception</code>：传入判断异常是否重试的函数</li><li><code>wrap_exception</code>：抛出错误的异常类型</li><li><code>retry_on_result</code>：在结果为指定条件时重试</li></ul>`,7);function _(u,m){const a=l("router-link");return o(),p("div",null,[d,s("nav",D,[s("ul",null,[s("li",null,[t(a,{to:"#_1-项目简介"},{default:r(()=>[n("1. 项目简介")]),_:1})])])]),y])}const v=e(i,[["render",_],["__file","retrying.html.vue"]]);export{v as default};

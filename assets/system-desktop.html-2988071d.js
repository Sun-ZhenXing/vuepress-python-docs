import{_ as s,o as n,c as a,e as l}from"./app-d1290edd.js";const p={},e=l(`<h1 id="python-获取系统桌面" tabindex="-1"><a class="header-anchor" href="#python-获取系统桌面" aria-hidden="true">#</a> Python 获取系统桌面</h1><h2 id="_1-windows-系统" tabindex="-1"><a class="header-anchor" href="#_1-windows-系统" aria-hidden="true">#</a> 1. Windows 系统</h2><p>通过注册表：</p><div class="language-python" data-ext="py"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> winreg</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">def</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">get_desktop_path</span><span style="color:#D4D4D4;">() -&gt; </span><span style="color:#4EC9B0;">str</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    key = winreg.OpenKey(</span></span>
<span class="line"><span style="color:#D4D4D4;">        winreg.HKEY_CURRENT_USER,</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#CE9178;">&quot;Software</span><span style="color:#D7BA7D;">\\\\</span><span style="color:#CE9178;">Microsoft</span><span style="color:#D7BA7D;">\\\\</span><span style="color:#CE9178;">Windows</span><span style="color:#D7BA7D;">\\\\</span><span style="color:#CE9178;">CurrentVersion</span><span style="color:#D7BA7D;">\\\\</span><span style="color:#CE9178;">Explorer</span><span style="color:#D7BA7D;">\\\\</span><span style="color:#CE9178;">Shell Folders&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">    )</span></span>
<span class="line"><span style="color:#D4D4D4;">    path = winreg.QueryValueEx(key, </span><span style="color:#CE9178;">&quot;Desktop&quot;</span><span style="color:#D4D4D4;">)[</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">]</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> path</span></span>
<span class="line"></span></code></pre></div><p>通过 Windows API <code>SHGetFolderPathW</code>：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> ctypes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">def</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">get_desktop_path</span><span style="color:#D4D4D4;">() -&gt; </span><span style="color:#4EC9B0;">str</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    CSIDL_DESKTOPDIRECTORY = </span><span style="color:#569CD6;">0x</span><span style="color:#B5CEA8;">0010</span></span>
<span class="line"><span style="color:#D4D4D4;">    buf = ctypes.create_unicode_buffer(</span><span style="color:#B5CEA8;">260</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">    ctypes.windll.shell32.SHGetFolderPathW(</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">None</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">        CSIDL_DESKTOPDIRECTORY,</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">None</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">        buf,</span></span>
<span class="line"><span style="color:#D4D4D4;">    )</span></span>
<span class="line"><span style="color:#D4D4D4;">    desktop_path = buf.value</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> desktop_path</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-mac-系统" tabindex="-1"><a class="header-anchor" href="#_2-mac-系统" aria-hidden="true">#</a> 2. Mac 系统</h2><p>尚未验证。</p><div class="language-python" data-ext="py"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">desktop_path = os.path.join(os.path.expanduser(</span><span style="color:#CE9178;">&quot;~&quot;</span><span style="color:#D4D4D4;">), </span><span style="color:#CE9178;">&quot;Desktop&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#DCDCAA;">print</span><span style="color:#D4D4D4;">(desktop_path)</span></span>
<span class="line"></span></code></pre></div>`,9),o=[e];function t(c,r){return n(),a("div",null,o)}const i=s(p,[["render",t],["__file","system-desktop.html.vue"]]);export{i as default};

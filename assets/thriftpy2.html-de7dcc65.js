import{_ as u,M as l,p as k,q as h,R as n,N as s,V as o,t,a1 as d}from"./framework-5f7e94ef.js";const _={},y=n("h1",{id:"thriftpy2-thrift-rpc-框架的",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#thriftpy2-thrift-rpc-框架的","aria-hidden":"true"},"#"),t(" thriftpy2 - Thrift RPC 框架的")],-1),f={class:"no-link"},g={href:"https://travis-ci.com/Thriftpy/thriftpy2",target:"_blank",rel:"noopener noreferrer"},m=n("img",{src:"https://travis-ci.com/Thriftpy/thriftpy2.svg?branch=develop",alt:"",loading:"lazy"},null,-1),v={href:"https://codecov.io/gh/Thriftpy/thriftpy2",target:"_blank",rel:"noopener noreferrer"},b=n("img",{src:"https://img.shields.io/codecov/c/github/Thriftpy/thriftpy2.svg",alt:"",loading:"lazy"},null,-1),w={href:"https://pypi.org/project/thriftpy2/",target:"_blank",rel:"noopener noreferrer"},P=n("img",{src:"https://img.shields.io/pypi/dm/thriftpy2.svg",alt:"",loading:"lazy"},null,-1),T={href:"https://pypi.org/project/thriftpy2/",target:"_blank",rel:"noopener noreferrer"},x=n("img",{src:"https://img.shields.io/pypi/v/thriftpy2.svg",alt:"",loading:"lazy"},null,-1),C={href:"https://pypi.org/project/thriftpy2/",target:"_blank",rel:"noopener noreferrer"},j=n("img",{src:"https://img.shields.io/pypi/pyversions/thriftpy2.svg",alt:"",loading:"lazy"},null,-1),z={href:"https://pypi.org/project/thriftpy2/",target:"_blank",rel:"noopener noreferrer"},E=n("img",{src:"https://img.shields.io/pypi/implementation/thriftpy2.svg",alt:"",loading:"lazy"},null,-1),N={class:"table-of-contents"},S=n("h2",{id:"_1-项目简介",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1-项目简介","aria-hidden":"true"},"#"),t(" 1. 项目简介")],-1),V=n("thead",null,[n("tr",null,[n("th",null,"项目"),n("th",null,"信息")])],-1),A=n("td",null,"项目地址",-1),D={href:"https://pypi.org/project/thriftpy2/",target:"_blank",rel:"noopener noreferrer"},I={href:"https://github.com/Thriftpy/thriftpy2",target:"_blank",rel:"noopener noreferrer"},R=n("td",null,"官方文档",-1),q={href:"https://thriftpy2.readthedocs.io/en/latest/",target:"_blank",rel:"noopener noreferrer"},B=n("tr",null,[n("td",null,"开源协议"),n("td",null,"MIT")],-1),L=n("tr",null,[n("td",null,"Python 版本"),n("td",null,"Python 2.7 ~ 3.11")],-1),M=n("tr",null,[n("td",null,"标签"),n("td",null,"RPC、asyncio")],-1),G=n("p",null,[t("ThriftPy2 是 Thrift RPC 框架的 Python 实现，它是官方 Thrift Python 包的另一个实现，兼容 "),n("code",null,"thriftpy"),t("，并且提供了无需编译 "),n("code",null,".thrift"),t(" 文件即可直接使用的功能。")],-1),H=n("code",null,"thriftpy",-1),F={href:"https://thriftpy2.readthedocs.io/en/latest/#benchmarks",target:"_blank",rel:"noopener noreferrer"},J=d(`<p>如果你需要使用 ThriftPy2，你需要安装 <code>cython</code> 和 <code>thriftpy2</code>：</p><div class="language-bash" data-ext="sh"><pre class="language-bash"><code>pip <span class="token function">install</span> cython thriftpy2
</code></pre></div><p>由于 ThriftPy2 兼容 <code>thriftpy</code>，所以你可以使用 <code>thriftpy</code> 的方式来使用 ThriftPy2：</p><div class="language-python" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> thriftpy2 <span class="token keyword">as</span> thriftpy
</code></pre></div><h2 id="_2-快速开始" tabindex="-1"><a class="header-anchor" href="#_2-快速开始" aria-hidden="true">#</a> 2. 快速开始</h2><p>下面所使用的 Thrift 文件如下：</p><div class="language-go" data-ext="go"><pre class="language-go"><code>service PingPong <span class="token punctuation">{</span>
    <span class="token builtin">string</span> <span class="token function">ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>基本示例：</p>`,8),K=n("div",{class:"language-python","data-ext":"py"},[n("pre",{class:"language-python"},[n("code",null,[n("span",{class:"token keyword"},"import"),t(` thriftpy2
`),n("span",{class:"token keyword"},"from"),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("rpc "),n("span",{class:"token keyword"},"import"),t(` make_server

pingpong_thrift `),n("span",{class:"token operator"},"="),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("load"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"pingpong.thrift"'),n("span",{class:"token punctuation"},","),t(" module_name"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"pingpong_thrift"'),n("span",{class:"token punctuation"},")"),t(`

`),n("span",{class:"token keyword"},"class"),t(),n("span",{class:"token class-name"},"Dispatcher"),n("span",{class:"token punctuation"},"("),n("span",{class:"token builtin"},"object"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),t(`
    `),n("span",{class:"token keyword"},"def"),t(),n("span",{class:"token function"},"ping"),n("span",{class:"token punctuation"},"("),t("self"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),t(`
        `),n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token string"},'"pong"'),t(`

server `),n("span",{class:"token operator"},"="),t(" make_server"),n("span",{class:"token punctuation"},"("),t("pingpong_thrift"),n("span",{class:"token punctuation"},"."),t("PingPong"),n("span",{class:"token punctuation"},","),t(" Dispatcher"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token string"},"'127.0.0.1'"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token number"},"6000"),n("span",{class:"token punctuation"},")"),t(`
server`),n("span",{class:"token punctuation"},"."),t("serve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`
`)])])],-1),O=n("div",{class:"language-python","data-ext":"py"},[n("pre",{class:"language-python"},[n("code",null,[n("span",{class:"token keyword"},"import"),t(` thriftpy2
`),n("span",{class:"token keyword"},"from"),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("rpc "),n("span",{class:"token keyword"},"import"),t(` make_client

pingpong_thrift `),n("span",{class:"token operator"},"="),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("load"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"pingpong.thrift"'),n("span",{class:"token punctuation"},","),t(" module_name"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"pingpong_thrift"'),n("span",{class:"token punctuation"},")"),t(`

client `),n("span",{class:"token operator"},"="),t(" make_client"),n("span",{class:"token punctuation"},"("),t("pingpong_thrift"),n("span",{class:"token punctuation"},"."),t("PingPong"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token string"},"'127.0.0.1'"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token number"},"6000"),n("span",{class:"token punctuation"},")"),t(`
`),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),t("client"),n("span",{class:"token punctuation"},"."),t("ping"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),t(`
`)])])],-1),Q=n("p",null,[t("同样支持 "),n("code",null,"asyncio"),t("，使用上述 Thrift 文件，我们可以这样写：")],-1),U=n("div",{class:"language-python","data-ext":"py"},[n("pre",{class:"language-python"},[n("code",null,[n("span",{class:"token keyword"},"import"),t(` asyncio
`),n("span",{class:"token keyword"},"import"),t(` thriftpy2
`),n("span",{class:"token keyword"},"from"),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("rpc "),n("span",{class:"token keyword"},"import"),t(` make_aio_server

echo_thrift `),n("span",{class:"token operator"},"="),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("load"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"echo.thrift"'),n("span",{class:"token punctuation"},","),t(" module_name"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"echo_thrift"'),n("span",{class:"token punctuation"},")"),t(`

`),n("span",{class:"token keyword"},"class"),t(),n("span",{class:"token class-name"},"Dispatcher"),n("span",{class:"token punctuation"},"("),n("span",{class:"token builtin"},"object"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),t(`
    `),n("span",{class:"token keyword"},"async"),t(),n("span",{class:"token keyword"},"def"),t(),n("span",{class:"token function"},"echo"),n("span",{class:"token punctuation"},"("),t("self"),n("span",{class:"token punctuation"},","),t(" param"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),t(`
        `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),t("param"),n("span",{class:"token punctuation"},")"),t(`
        `),n("span",{class:"token keyword"},"await"),t(" asyncio"),n("span",{class:"token punctuation"},"."),t("sleep"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0.1"),n("span",{class:"token punctuation"},")"),t(`
        `),n("span",{class:"token keyword"},"return"),t(` param

`),n("span",{class:"token keyword"},"def"),t(),n("span",{class:"token function"},"main"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),t(`
    server `),n("span",{class:"token operator"},"="),t(" make_aio_server"),n("span",{class:"token punctuation"},"("),t(`
        echo_thrift`),n("span",{class:"token punctuation"},"."),t("EchoService"),n("span",{class:"token punctuation"},","),t(" Dispatcher"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token string"},"'127.0.0.1'"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token number"},"6000"),n("span",{class:"token punctuation"},")"),t(`
    server`),n("span",{class:"token punctuation"},"."),t("serve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`

`),n("span",{class:"token keyword"},"if"),t(" __name__ "),n("span",{class:"token operator"},"=="),t(),n("span",{class:"token string"},"'__main__'"),n("span",{class:"token punctuation"},":"),t(`
    main`),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`
`)])])],-1),W=n("div",{class:"language-python","data-ext":"py"},[n("pre",{class:"language-python"},[n("code",null,[n("span",{class:"token keyword"},"import"),t(` thriftpy2
`),n("span",{class:"token keyword"},"import"),t(` asyncio
`),n("span",{class:"token keyword"},"from"),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("rpc "),n("span",{class:"token keyword"},"import"),t(` make_aio_client

echo_thrift `),n("span",{class:"token operator"},"="),t(" thriftpy2"),n("span",{class:"token punctuation"},"."),t("load"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"echo.thrift"'),n("span",{class:"token punctuation"},","),t(" module_name"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"echo_thrift"'),n("span",{class:"token punctuation"},")"),t(`

`),n("span",{class:"token keyword"},"async"),t(),n("span",{class:"token keyword"},"def"),t(),n("span",{class:"token function"},"request"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),t(`
    client `),n("span",{class:"token operator"},"="),t(),n("span",{class:"token keyword"},"await"),t(" make_aio_client"),n("span",{class:"token punctuation"},"("),t(`
        echo_thrift`),n("span",{class:"token punctuation"},"."),t("EchoService"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token string"},"'127.0.0.1'"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token number"},"6000"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"await"),t(" client"),n("span",{class:"token punctuation"},"."),t("echo"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'hello, world'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),t(`
    client`),n("span",{class:"token punctuation"},"."),t("close"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`

`),n("span",{class:"token keyword"},"if"),t(" __name__ "),n("span",{class:"token operator"},"=="),t(),n("span",{class:"token string"},"'__main__'"),n("span",{class:"token punctuation"},":"),t(`
    loop `),n("span",{class:"token operator"},"="),t(" asyncio"),n("span",{class:"token punctuation"},"."),t("get_event_loop"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`
    loop`),n("span",{class:"token punctuation"},"."),t("run_until_complete"),n("span",{class:"token punctuation"},"("),t("request"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),t(`
`)])])],-1);function X(Y,Z){const a=l("ExternalLinkIcon"),i=l("router-link"),r=l("CodeTabs");return k(),h("div",null,[y,n("div",f,[n("p",null,[n("a",g,[m,s(a)]),n("a",v,[b,s(a)]),n("a",w,[P,s(a)]),n("a",T,[x,s(a)]),n("a",C,[j,s(a)]),n("a",z,[E,s(a)])])]),n("nav",N,[n("ul",null,[n("li",null,[s(i,{to:"#_1-项目简介"},{default:o(()=>[t("1. 项目简介")]),_:1})]),n("li",null,[s(i,{to:"#_2-快速开始"},{default:o(()=>[t("2. 快速开始")]),_:1})])])]),S,n("table",null,[V,n("tbody",null,[n("tr",null,[A,n("td",null,[n("a",D,[t("PyPI"),s(a)]),t(" | "),n("a",I,[t("GitHub"),s(a)])])]),n("tr",null,[R,n("td",null,[n("a",q,[t("官方文档"),s(a)])])]),B,L,M])]),G,n("p",null,[t("ThriftPy2 的速度比 "),H,t(" 快许多，这可以从官方的 "),n("a",F,[t("benchmark"),s(a)]),t(" 中找到。")]),J,s(r,{id:"92",data:[{title:"Server"},{title:"Client"}]},{tab0:o(({title:e,value:p,isActive:c})=>[K]),tab1:o(({title:e,value:p,isActive:c})=>[O]),_:1}),Q,s(r,{id:"103",data:[{title:"Server"},{title:"Client"}]},{tab0:o(({title:e,value:p,isActive:c})=>[U]),tab1:o(({title:e,value:p,isActive:c})=>[W]),_:1})])}const nn=u(_,[["render",X],["__file","thriftpy2.html.vue"]]);export{nn as default};
